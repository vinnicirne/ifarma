# ๐๏ธ ARQUITETURA DO SISTEMA DE CATรLOGO

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                         CAMADA DE APRESENTAรรO                          โ
โ                              (Frontend React)                            โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                                    โ
                    โโโโโโโโโโโโโโโโโผโโโโโโโโโโโโโโโโ
                    โ               โ               โ
                    โผ               โผ               โผ
        โโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโ
        โ    ADMIN     โ  โ   MERCHANT   โ  โ   CLIENTE    โ
        โ  Dashboard   โ  โ  Dashboard   โ  โ     App      โ
        โโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโ
                โ               โ               โ
                โ               โ               โ
                โผ               โผ               โผ
        โโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโ
        โ Categories   โ  โ  Inventory   โ  โ   Search     โ
        โ Collections  โ  โ   Control    โ  โ   Browse     โ
        โ   Badges     โ  โ Team Mgmt    โ  โ   Cart       โ
        โโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโ
                                    โ
                                    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                         CAMADA DE DADOS                                 โ
โ                        (Supabase PostgreSQL)                            โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                      CATรLOGO GLOBAL (Read-Only)                        โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                                                         โ
โ   โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ         โ
โ   โ              product_catalog (ANVISA)                    โ         โ
โ   โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค         โ
โ   โ โข 10.000+ produtos de referรชncia                         โ         โ
โ   โ โข Dados oficiais (nome, marca, princรญpio ativo)          โ         โ
โ   โ โข EAN รบnico                                              โ         โ
โ   โ โข Busca full-text (pg_trgm)                              โ         โ
โ   โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ         โ
โ                              โ                                          โ
โ                              โ (Importaรงรฃo/Referรชncia)                  โ
โ                              โผ                                          โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                    INVENTรRIO POR FARMรCIA                              โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                                                         โ
โ   โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ         โ
โ   โ                      products                            โ         โ
โ   โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค         โ
โ   โ โข pharmacy_id (FK)                                       โ         โ
โ   โ โข Preรงos especรญficos da farmรกcia                         โ         โ
โ   โ โข Estoque local                                          โ         โ
โ   โ โข Campos enriquecidos:                                   โ         โ
โ   โ   - dosage, quantity_label                               โ         โ
โ   โ   - principle_active[], tags[], synonyms[]               โ         โ
โ   โ   - control_level, usage_instructions                    โ         โ
โ   โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ         โ
โ                              โ                                          โ
โ                              โ (Relacionamentos)                        โ
โ                              โผ                                          โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                    TAXONOMIA & ORGANIZAรรO                              โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                                                         โ
โ   โโโโโโโโโโโโโโโโโโโโ      โโโโโโโโโโโโโโโโโโโโ                      โ
โ   โ   categories     โ      โ   collections    โ                      โ
โ   โโโโโโโโโโโโโโโโโโโโค      โโโโโโโโโโโโโโโโโโโโค                      โ
โ   โ โข Hierรกrquicas   โ      โ โข Por sintoma    โ                      โ
โ   โ โข parent_id      โ      โ โข Por pรบblico    โ                      โ
โ   โ โข description    โ      โ โข Campanhas      โ                      โ
โ   โ                  โ      โ โข Sazonalidade   โ                      โ
โ   โโโโโโโโโโฌโโโโโโโโโโ      โโโโโโโโโโฌโโโโโโโโโโ                      โ
โ            โ                         โ                                 โ
โ            โ                         โ                                 โ
โ            โโโโโโโโโโฌโโโโโโโโโโโโโโโโโ                                 โ
โ                     โ                                                  โ
โ                     โผ                                                  โ
โ         โโโโโโโโโโโโโโโโโโโโโโโโโโโ                                   โ
โ         โ  product_collections    โ                                   โ
โ         โ  (Tabela de Junรงรฃo)     โ                                   โ
โ         โโโโโโโโโโโโโโโโโโโโโโโโโโโ                                   โ
โ                                                                         โ
โ   โโโโโโโโโโโโโโโโโโโโ      โโโโโโโโโโโโโโโโโโโโ                      โ
โ   โ     badges       โ      โ product_badges   โ                      โ
โ   โโโโโโโโโโโโโโโโโโโโค      โโโโโโโโโโโโโโโโโโโโค                      โ
โ   โ โข Mais Vendido   โโโโโโโโค (Tabela Junรงรฃo)  โ                      โ
โ   โ โข Melhor Preรงo   โ      โ                  โ                      โ
โ   โ โข Entrega Rรกpida โ      โ                  โ                      โ
โ   โโโโโโโโโโโโโโโโโโโโ      โโโโโโโโโโโโโโโโโโโโ                      โ
โ                                                                         โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                         FLUXO DE DADOS                                  โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

1. CADASTRO DE PRODUTO (Merchant)
   โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
   โ Merchant busca "Dipirona" no product_catalog           โ
   โ                    โผ                                    โ
   โ Seleciona produto โ Campos preenchidos automaticamente โ
   โ                    โผ                                    โ
   โ Adiciona: preรงo, estoque, dosagem, tags                โ
   โ                    โผ                                    โ
   โ Salva em products (com pharmacy_id)                    โ
   โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

2. ORGANIZAรรO (Admin)
   โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
   โ Admin cria categoria "Medicamentos"                     โ
   โ                    โผ                                    โ
   โ Cria subcategoria "Analgรฉsicos" (parent_id)            โ
   โ                    โผ                                    โ
   โ Cria coleรงรฃo "Dor e Febre" (tipo: sintoma)             โ
   โ                    โผ                                    โ
   โ Vincula produtos ร coleรงรฃo (product_collections)       โ
   โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

3. BUSCA (Cliente)
   โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
   โ Cliente busca "dor de cabeรงa"                           โ
   โ                    โผ                                    โ
   โ Sistema busca em:                                       โ
   โ   โข products.tags[] โ ["dor", "cabeรงa"]                โ
   โ   โข products.synonyms[] โ ["cefaleia"]                 โ
   โ   โข collections โ "Dor e Febre"                        โ
   โ                    โผ                                    โ
   โ Retorna produtos relevantes de farmรกcias prรณximas      โ
   โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                      SEGURANรA (RLS)                                    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

product_catalog:
  โ SELECT: Todos (public)
  โ INSERT/UPDATE/DELETE: Apenas Staff

categories, collections, badges:
  โ SELECT: Todos (public)
  โ INSERT/UPDATE/DELETE: Apenas Admin/Operator

products:
  โ SELECT: Todos (public)
  โ INSERT/UPDATE: Apenas dono da farmรกcia
  โ DELETE: Apenas dono da farmรกcia

product_collections, product_badges:
  โ SELECT: Todos (public)
  โ INSERT/UPDATE/DELETE: Admin ou dono da farmรกcia

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                    PERFORMANCE & ESCALABILIDADE                         โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

รNDICES:
  โ product_catalog.name (GIN trigram) โ Busca full-text
  โ product_catalog.ean (B-tree) โ Busca exata
  โ products.brand (B-tree) โ Filtro por marca
  โ categories.parent_id (B-tree) โ Hierarquia

OTIMIZAรรES:
  โ Arrays (tags, synonyms) โ Busca eficiente com GIN
  โ Catรกlogo separado โ Nรฃo duplica dados
  โ RLS policies โ Seguranรงa sem overhead

CAPACIDADE:
  โ 100.000+ produtos no catรกlogo
  โ 10.000+ farmรกcias
  โ 1.000.000+ produtos individuais (estoque)
  โ Busca < 50ms (com รญndices)

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                         PRรXIMAS FEATURES                               โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

CURTO PRAZO:
  โณ Pรกgina de Coleรงรตes no app cliente
  โณ Filtros por coleรงรฃo na busca
  โณ Badges visuais nos cards de produto

MรDIO PRAZO:
  โณ IA para recomendaรงรฃo (usar tags/synonyms)
  โณ Substituiรงรฃo automรกtica (genรฉricos)
  โณ Cross-sell inteligente

LONGO PRAZO:
  โณ Importaรงรฃo automรกtica ANVISA (API oficial)
  โณ Anรกlise de tendรชncias (produtos mais buscados)
  โณ Precificaรงรฃo dinรขmica (sugestรตes)
```

---

**Legenda:**
- `โโโ` = Mรณdulo/Componente
- `โ` = Relaรงรฃo/Fluxo
- `โผ` = Direรงรฃo do fluxo
- `โโ` = Relacionamento FK
- `โ` = Implementado
- `โณ` = Planejado

---

**รltima Atualizaรงรฃo:** 2026-02-09 23:44
